<tr>
    
    <td class="ps-4">
        <div class="d-flex align-items-center">
            <div class="avatar-circle {% if task.assigned_to == user %}bg-primary-subtle text-primary border border-primary{% else %}bg-info-subtle text-info border border-info{% endif %}">
                <i class="fas {% if task.assigned_to == user %}fa-user-tie{% else %}fa-users-cog{% endif %}"></i>
            </div>
            <div>
                <div class="fw-bold text-dark fs-6">{{ task.title|truncatechars:35 }}</div>
                <div class="d-flex gap-2 align-items-center mt-1">
                    <small class="text-muted"><i class="far fa-calendar-alt me-1"></i>{{ task.due_date|date:"d M" }}</small>
                </div>
            </div>
        </div>
    </td>
    
    <td style="min-width: 180px;">
        <div class="d-flex justify-content-between align-items-center mb-1">
            <span class="small fw-bold text-dark">{{ task.spent_hours|default:"0" }} <span class="text-muted fw-normal">/ {{ task.planned_hours }}</span></span>
            <span class="small fw-extrabold text-primary">{% widthratio task.spent_hours task.planned_hours 100 %}%</span>
        </div>
        
        <div class="progress progress-custom mb-1">
            <div class="progress-bar {% if task.spent_hours > task.planned_hours %}bg-danger{% else %}bg-primary{% endif %}" 
                 style="width: {% widthratio task.spent_hours task.planned_hours 100 %}%"></div>
        </div>
        
        {% if task.total_steps > 0 %}
        <div class="d-flex align-items-center gap-2 mt-1">
            <div class="progress flex-grow-1" style="height: 3px;">
                <div class="progress-bar bg-warning" style="width: {% widthratio task.completed_steps task.total_steps 100 %}%"></div>
            </div>
            <span class="text-muted" style="font-size: 0.6rem; font-weight: 700;">{{ task.completed_steps }}/{{ task.total_steps }}</span>
        </div>
        {% endif %}
    </td>
    
    <td>
        <div class="px-3 py-1 bg-light border rounded-pill d-inline-flex align-items-center">
            <span class="fw-bold text-dark small">{{ task.user_contribution|default_if_none:0|floatformat:"-1" }} sa</span>
        </div>
    </td>
    
    <td>
        {% if task.status == 'tamamlandi' %}
            <span class="badge-soft bg-success-subtle text-success">Tamamlandı</span>
        {% elif task.priority == 'yuksek' %}
            <span class="badge-soft bg-danger-subtle text-danger">Yüksek</span>
        {% else %}
            <span class="badge-soft bg-light text-dark border">{{ task.get_status_display }}</span>
        {% endif %}
    </td>
    
    <td class="text-end pe-4">
        {% if task.status != 'tamamlandi' %}
        <button type="button" class="btn btn-sm btn-light border shadow-sm rounded-circle me-2" 
                title="Hızlı Çalışma Gir"
                onclick="openQuickLogModal('{{ task.id }}', '{{ task.title|escapejs }}')">
            <i class="fas fa-stopwatch text-primary"></i>
        </button>
        {% endif %}
        
        <a href="{% url 'task_detail' task.pk %}" class="btn btn-sm btn-outline-primary rounded-pill px-3 shadow-sm fw-bold">
            Detay
        </a>
    </td>
</tr>